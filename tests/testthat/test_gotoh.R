library(amplican)
context("Gotoh algorithm")

test_that("gotoh algorithm works as intended", {
  expect_equal(gRCPP("aaaaa", "aaddttaaaa"), "****************\nSEQUENCES \n----------------\nPattern: aaaaa\nSubject: aaddttaaaa\n****************\nSCORING INFO \n----------------\nScore matrix:       NUC44\nGap opening:        50\nGap extension:      0\nGap ending penalty: 0\n****************\nRESULTS \n----------------\nAlignment Length: 11\nScore: 16\n\naaaaa------    11\n ||..          \n-aaddttaaaa    \n****************\nALIGNMENT INFO \n----------------\nTotal Insertions: 0\nTotal Deletions:  1\nTotal Mismatches: 2\n----------------\nINSERTIONS: \n----------------\n\n--Insertions respect patterns coordinates-- \n\n\n----------------\nDELETIONS: \n----------------\nIn Pattern\nSTART: 6\nEND:   11\n\n\n--Deletions respect subject coordinates-- \n\nIn Pattern\nSTART: 5\nEND:   10\n\n\n----------------\nMISMATCHES: \n----------------\nSTART:    3\nORIGINAL: d\nMUTATED:  a\n\nSTART:    4\nORIGINAL: d\nMUTATED:  a\n\n\n--Missmatches respect subject coordinates-- \n\nSTART:    2\nORIGINAL: d\nMUTATED:  a\n\nSTART:    3\nORIGINAL: d\nMUTATED:  a\n\n\n\n****************\n++++\n@0@!@1@6,11*!@2@3,d,a*4,d,a*\n++++\n@0@!@1@5,10*!@2@2,d,a*3,d,a*\n++++\naaaaa------\n++++\n-aaddttaaaa\n")
  expect_equal(gRCPP("aaaaa", "aaddttaaaa", "NUC44", 30, 5), "****************\nSEQUENCES \n----------------\nPattern: aaaaa\nSubject: aaddttaaaa\n****************\nSCORING INFO \n----------------\nScore matrix:       NUC44\nGap opening:        30\nGap extension:      5\nGap ending penalty: 0\n****************\nRESULTS \n----------------\nAlignment Length: 11\nScore: 16\n\naaaaa------    11\n ||..          \n-aaddttaaaa    \n****************\nALIGNMENT INFO \n----------------\nTotal Insertions: 0\nTotal Deletions:  1\nTotal Mismatches: 2\n----------------\nINSERTIONS: \n----------------\n\n--Insertions respect patterns coordinates-- \n\n\n----------------\nDELETIONS: \n----------------\nIn Pattern\nSTART: 6\nEND:   11\n\n\n--Deletions respect subject coordinates-- \n\nIn Pattern\nSTART: 5\nEND:   10\n\n\n----------------\nMISMATCHES: \n----------------\nSTART:    3\nORIGINAL: d\nMUTATED:  a\n\nSTART:    4\nORIGINAL: d\nMUTATED:  a\n\n\n--Missmatches respect subject coordinates-- \n\nSTART:    2\nORIGINAL: d\nMUTATED:  a\n\nSTART:    3\nORIGINAL: d\nMUTATED:  a\n\n\n\n****************\n++++\n@0@!@1@6,11*!@2@3,d,a*4,d,a*\n++++\n@0@!@1@5,10*!@2@2,d,a*3,d,a*\n++++\naaaaa------\n++++\n-aaddttaaaa\n")
  expect_equal(gRCPP("aaaaa", "aaddttaaaa", "NUC44", 30, 5, TRUE, TRUE), "****************\nSEQUENCES \n----------------\nPattern: aaaaa\nSubject: aaddttaaaa\n****************\nSCORING INFO \n----------------\nScore matrix:       NUC44\nGap opening:        30\nGap extension:      5\nGap ending penalty: 1\n****************\nRESULTS \n----------------\nAlignment Length: 10\nScore: 16\n\n-----aaaaa    10\n     .||||    \naaddttaaaa    \n****************\nALIGNMENT INFO \n----------------\nTotal Insertions: 0\nTotal Deletions:  1\nTotal Mismatches: 1\n----------------\nINSERTIONS: \n----------------\n\n--Insertions respect patterns coordinates-- \n\n\n----------------\nDELETIONS: \n----------------\nIn Pattern\nSTART: 1\nEND:   5\n\n\n--Deletions respect subject coordinates-- \n\nIn Pattern\nSTART: 1\nEND:   5\n\n\n----------------\nMISMATCHES: \n----------------\nSTART:    5\nORIGINAL: t\nMUTATED:  a\n\n\n--Missmatches respect subject coordinates-- \n\nSTART:    5\nORIGINAL: t\nMUTATED:  a\n\n\n\n****************\n++++\n@0@!@1@1,5*!@1@5,t,a*\n++++\n@0@!@1@1,5*!@1@5,t,a*\n++++\n-----aaaaa\n++++\naaddttaaaa\n")
})
